<!doctype html>
<html lang="en">
  <head>

    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css" integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <link href="https://unpkg.com/tailwindcss@^1.0/dist/tailwind.min.css" rel="stylesheet">

	<link rel="icon" href="image\gpa-calculator-green.png" type="image/icon type">
    <title>NSU CGPA Calculator - Perahin NSUer!</title>
  </head>
  <body>     
    <section class="text-gray-700 body-font">
        <div class="container px-5 py-10 mx-auto">
            <img src="image\gpa-calculator.png" class="rounded mx-auto d-block" alt="North South University CGPA Calculator - Perahin NSUer!" width="100" height="100">
          <div class="flex flex-col text-center w-full mb-3">
            <h1 class="sm:text-4xl text-3xl font-medium title-font mb-2 text-gray-900">NSU CGPA Calculator</h1>
            <p class="lg:w-2/3 mx-auto leading-relaxed text-base">Calculate Your own CGPA by yourself is now very esay. No need to wait for Updateing RDS.</p>
          </div>
          <div class="lg:w-2/3 w-full mx-auto overflow-auto">
            <table class="table-auto w-full text-left whitespace-no-wrap table-striped table-dark">
                <tbody id="mainTableBody">
                <tr>
                    <td class="px-4 py-3" style="text-align:center; font-size:1.5vw"><strong><i>Previous:</i></strong></td>
                    <td>  
                        <div class="px-4 py-3">
                        <input class="form-control" id="prevCr"  placeholder="Credits" type="number">
                        </div>
                    </td>
                    <td>  
                        <div class="px-4 py-3">
                        <input class="form-control" id="prevCg" placeholder="CGPA" type="number">
                        </div>
                    </td>
                </tr>
                <tr>
                    <td>  
                        <div class="px-4 py-3">
                        <input class="form-control" id="Course1" placeholder="Course Initial" type="text">
                        </div>
                    </td>
                    <td>  
                        <div class="px-4 py-3">
                        <input class="form-control" id="cr1" placeholder="Credits" type="number">
                        </div>
                    </td>
                    <td>  
                        <div class="px-4 py-3">
                        <select class="nice-select form-control"  id="gr1">
                            <option>A</option>
                            <option>A-</option>
                            <option>B+</option>
                            <option>B</option>
                            <option>B-</option>
                            <option>C+</option>
                            <option>C</option>
                            <option>C-</option>
                            <option>D+</option>
                            <option>D</option>
                            <option>F</option>
                        </select>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td>  
                        <div class="px-4 py-3">
                        <input class="form-control" id="Course2" placeholder="Course Initial" type="text">
                        </div>
                    </td>
                    <td>  
                        <div class="px-4 py-3">
                        <input class="form-control" id="cr2" placeholder="Credits" type="number">
                        </div>
                    </td>
                    <td>  
                        <div class="px-4 py-3">
                        <select class="nice-select form-control" id="gr2">
                            <option>A</option>
                            <option>A-</option>
                            <option>B+</option>
                            <option>B</option>
                            <option>B-</option>
                            <option>C+</option>
                            <option>C</option>
                            <option>C-</option>
                            <option>D+</option>
                            <option>D</option>
                            <option>F</option>
                        </select>
                        </div>
                    </td>
                </tr>
                <tr>
                    <td>  
                        <div class="px-4 py-3">
                        <input class="form-control" id="Course3" placeholder="Course Initial" type="text">
                        </div>
                    </td>
                    <td>  
                        <div class="px-4 py-3">
                        <input class="form-control" id="cr3" placeholder="Credits" type="number">
                        </div>
                    </td>
                    <td>  
                        <div class="px-4 py-3">
                        <select class="nice-select form-control"  id="gr3">
                            <option>A</option>
                            <option>A-</option>
                            <option>B+</option>
                            <option>B</option>
                            <option>B-</option>
                            <option>C+</option>
                            <option>C</option>
                            <option>C-</option>
                            <option>D+</option>
                            <option>D</option>
                            <option>F</option>
                        </select>
                        </div>
                    </td>
                </tr>
              </tbody>
            </table>
          </div>
          <div class="flex pl-4 mt-4 lg:w-2/3 w-full mx-auto">
            <button class=" btn btn-outline-success my-2 my-sm-0 " id="addCourse"><b>+ Add Course</b></button>
            <button class="flex ml-auto text-white bg-success border-0 py-2 px-6 focus:outline-none hover:bg-indigo-600 rounded" id="calculateCg" >Calculate CGPA</button>
          </div>
          <div class="lg:w-2/3 w-full mx-auto overflow-auto py-10" id="calculatedCgShow">
            <table class="table-auto w-full text-center whitespace-no-wrap table-striped table-dark">
                <tbody>
                <tr>
                    <td class="px-4 py-3" style="text-align:center; font-size:2vw; ">
                        <h2>Cradit Passed</h2>
                        <p style="font-size:3vw"><strong id="craditPassed">000</strong></p>
                    </td>
                    <td class="px-4 py-3 bg-success" style="text-align:center; font-size:2vw">
                        <h2>CGPA</h2>
                        <p style="font-size:3vw"><strong id="cgpaShow">0.00</strong></p>  
                    </td>
                </tr>
                </tbody>
            </table>
          </div>
        </div>
      </section>


    <script src="https://code.jquery.com/jquery-3.5.1.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ho+j7jyWK8fNQe+A12Hb8AhRq26LrZ/JpcUGGOn+Y7RsweNrtN/tE3MoK7ZeZDyx" crossorigin="anonymous"></script>

    <script>
        let courseNo = 3;
        addCourse = document.getElementById("addCourse");
        addCourse.addEventListener("click", ()=>{
            courseNo+=1;
            let cr = "cr"+courseNo;
            let gr = "gr"+courseNo;
            
            let strq = ''
            strq = '<tr><td><div class="px-4 py-3"><input class="form-control" placeholder="Course Initial" type="text"> </div></td><td><div class="px-4 py-3"><input class="form-control" id='+
                        cr+' placeholder="Credits" type="number"></div></td>\<td>'+
                        '<div class="px-4 py-3">'+
                        '<select class="nice-select form-control" id='+gr+'>'+
                            '<option>A</option><option>A-</option><option>B+</option><option>B</option><option>B-</option><option>C+</option><option>C</option><option>C-</option><option>D+</option><option>D</option><option>F</option>'+
                        '</select></div></td></tr>';
            document.getElementById("mainTableBody").insertAdjacentHTML('afterend', strq);
            console.log("course added");
        })

        calculateCg = document.getElementById("calculateCg");
        calculateCg.addEventListener("click", ()=>{
            let cg = 0;
            for(let i=1 ; i<=courseNo; i++)
            {
                
                let cr = "cr"+i;
                let gr = "gr"+i;
                //console.log(cr);
                cradit = document.getElementById(cr).value;
                grade = document.getElementById(gr).value;
                switch(grade)  
                {    
                    default: cg=0;  
                        break;  
                    case "A": cg=4;  
                        break;  
                    case "A-": cg=3.7;  
                        break;  
                    case "B+": cg=3.3;  
                        break;  
                    case "B": cg=3;  
                        break;  
                    case "B-": cg=2.7;  
                        break;
                    case "C+": cg=2.3;  
                    break;
                    case "C": cg=2;  
                    break;
                    case "C-": cg=1.7;  
                    break;
                    case "D+": cg=1.3;  
                    break;
                    case "D": cg=1;  
                    break;
                    case "F": cg=0;  
                    break;  
                } 
                //console.log(cg);
                //console.log(localStorage.getItem('itemsJson'));
                if (localStorage.getItem('itemsJson') !== null){
                    itemJsonArrayStr = localStorage.getItem('itemsJson');
                    console.log('jaka')
                    console.log(itemJsonArrayStr);
                    itemJsonArray = JSON.parse(itemJsonArrayStr);
                   // console.log(itemJsonArraystr);
                    itemJsonArray.push([cradit, cg]);
                    localStorage.setItem('itemsJson', JSON.stringify(itemJsonArray));
                }
                else{
                    itemJsonArray = [];
                    itemJsonArray.push([cradit, cg]);
                    localStorage.setItem('itemsJson', JSON.stringify(itemJsonArray));
                }
            }
            let totalCradit = 0;
            let totalCgSum = 0;

            itemJsonArray.forEach(myFunction);
            //console.log(itemJsonArray)
            function myFunction(item, index) {
                /* item[0] : cradit
                   item[1] : cg
                */
               console.log(typeof Number(item[0]))
               totalCradit+=Number(item[0]);
               totalCgSum += Number((item[1])*Number(item[0]));
            }
            //console.log(totalCradit,totalCgSum);
            a = Number(document.getElementById("prevCg").value);
            b = Number(document.getElementById("prevCr").value);
            //console.log(a,b);
            totalCgSum+=(a*b);
            totalCradit+=b;
            let finalCg = (totalCgSum/totalCradit);
            //console.log("Cgpa Calculated "+finalCg);
            document.getElementById("craditPassed").innerHTML = totalCradit;
            document.getElementById("cgpaShow").innerHTML = finalCg.toFixed(2);

            localStorage.clear();
        })
    </script>
  </body>
</html>